!function(t,e){"function"==typeof define&&define.amd?define([],e):"undefined"!=typeof module&&module.exports?module.exports=e():t.OfflineModel=e()}(this,function(){"use strict";var t={secret:"",storageType:"localStorage",init:function(t){Object.assign(this,t)},encrypt:function(t){var e=JSON.stringify(t);return e},decrypt:function(t){var e=JSON.parse(t);return!e.expiry||e.expiry<=Date.now()?e:null},get:function(t){var e=window[this.storageType].getItem(t);return e&&this.decrypt(e)},set:function(t,e,r){if(!e)return this.remove(t),!1;if(r){var n=new Date;n+=r,e.expiry=new Date(n)}var i=this.encrypt(e);return window[this.storageType].setItem(t,i),!0},remove:function(t){return window[this.storageType].removeItem(t),!0},clearAll:function(){return window[this.storageType].clear(),!0}};const e=function(t,e){return t.map(function(t){return t[e]}).reduce(function(t,e){return Math.max(t,e)},0)};var r=null,n="localStorage",i={primaryKey:"_id",fields:null,key:null,secret:"my-awesome-key",init:function(e,r){r=r||{},Object.assign(this,r),t.storageType=n,t.init({secret:this.secret});var i=t.get(this.key);return Array.isArray(i)&&(e=i),Array.isArray(this.fields)&&(e=this.createValueObjects(e)),t.set(this.key,e),this.setListItems(e),this},createValueObjects:function(t){var e=this;return t=t.map(function(t){return e.createValueObject(t)})},createValueObject:function(t){var e={};return this.fields.forEach(function(r){e[r]=t[r]||""}),e},setStorageType:function(t){return n=t,this},setKey:function(t){return this.key=t,this},getKey:function(){return this.key},setListItems:function(t){return r=t,this},getListItems:function(){return r},setFields:function(t){return this.fields=t,this},countTotalItems:function(t){return e(t,this.primaryKey)+1},create:function(e){return e=this.createValueObject(e),e[this.primaryKey]=this.countTotalItems(r),r.push(e),t.set(this.key,r),r},update:function(e){var n=this;return r=r.map(function(t){return t[n.primaryKey]===e[n.primaryKey]&&(t=n.createValueObject(e)),t}),t.set(this.key,r),r},delete:function(e){var r=this.getListItems(),n=this,i=r.filter(function(t){return t[n.primaryKey]===e})[0];return i?(r=r.filter(function(t){return t[n.primaryKey]!==i[n.primaryKey]}),this.setListItems(r),t.set(this.key,r),i):!!i},clearAll:function(){return r=[],t.clearAll()}};return i});