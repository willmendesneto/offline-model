!function(t){"use strict";var e={secret:"",storageType:"localStorage",init:function(t){Object.assign(this,t)},encrypt:function(t){var e=JSON.stringify(t);return e},decrypt:function(t){var e=JSON.parse(t);return e},get:function(e){var r=t[this.storageType].getItem(e);return r&&this.decrypt(r)},set:function(e,r){if(!r)return this.remove(e),!1;var n=this.encrypt(r);return t[this.storageType].setItem(e,n),!0},remove:function(e){return t[this.storageType].removeItem(e),!0},clearAll:function(){return t[this.storageType].clear(),!0}};const r=function(t,e){return t.map(function(t){return t[e]}).reduce(function(t,e){return Math.max(t,e)},0)};var n=null,i="localStorage",s={primaryKey:"_id",fields:null,key:null,secret:"my-awesome-key",init:function(t,r){r=r||{},Object.assign(this,r),e.storageType=i,e.init({secret:this.secret});var n=e.get(this.key);return Array.isArray(n)&&(t=n),Array.isArray(this.fields)&&(t=this.createValueObjects(t)),e.set(this.key,t),this.setListItems(t),this},createValueObjects:function(t){var e=this;return t=t.map(function(t){return e.createValueObject(t)})},createValueObject:function(t){var e={};return this.fields.forEach(function(r){e[r]=t[r]||""}),e},setStorageType:function(t){return i=t,this},setKey:function(t){return this.key=t,this},getKey:function(){return this.key},setListItems:function(t){return n=t,this},getListItems:function(){return n},setFields:function(t){return this.fields=t,this},countTotalItems:function(t){return r(t,this.primaryKey)+1},create:function(t){return t=this.createValueObject(t),t[this.primaryKey]=this.countTotalItems(n),n.push(t),e.set(this.key,n),n},update:function(t){var r=this;return n=n.map(function(e){return e[r.primaryKey]===t[r.primaryKey]&&(e=r.createValueObject(t)),e}),e.set(this.key,n),n},delete:function(t){var r=this.getListItems(),n=this,i=r.filter(function(e){return e[n.primaryKey]===t})[0];return i?(r=r.filter(function(t){return t[n.primaryKey]!==i[n.primaryKey]}),this.setListItems(r),e.set(this.key,r),i):!!i},clearAll:function(){return n=[],e.clearAll()}};"undefined"!=typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:t.OfflineModel=s}(window?window:global);